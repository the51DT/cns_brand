<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title><%= data.title %></title>
    <meta name="description" content="<%= data.description %>">
    <link rel="stylesheet" href="/src/assets/css/index.css" />
    <link rel="shortcut icon" href="/src/assets/image/favicon.ico">
</head>
<body class="dark-mode">
    <div class="wrap has-hero bizinfo-LG-way">
        <%- include('src/_inc/header.html') %>
        <!-- //헤더 영역 -->
        <!-- //비주얼 영역 -->
        <div class="sub-content__wrap">
            <div class="bizinfo-LG-way__container">
                <!-- 내비 -->
                <div class="full-sec__pagination">
                    <div class="full-sec__pagination--item font-caption-xl is-active">LG 비전</div>
                    <div class="full-sec__pagination--item font-caption-xl">행동방식</div>
                    <div class="full-sec__pagination--item font-caption-xl">경영이념</div>
                </div>
                <!-- //내비 -->
                <!-- 이미지 -->
                <div class="full-sec__img">
                    <div class="full-sec__img--01"></div>
                    <div class="full-sec__img--02"></div>
                    <div class="full-sec__img--03 is-active"></div>
                </div>
                <!-- //이미지 -->

                <div class="bizinfo-LG-way__section full-sec bizinfo-LG-way__section--01">
                    <div class="inner-wrap">
                        <div class="bizinfo-LG-way__textarea">
                            <h2 class="font-head-xl font-bold">LG Way</h2>
                            <p class="font-head-sm font-medium">
                                LG 고유의 경영철학이자, 전 임직원이 지키고<br/>
                                실천해야 할 사고와 행동의 기반입니다.
                            </p>
                            <p class="font-body-sm">
                                경영이념인 ‘고객을 위한 가치창조’와 ‘인간존중의 경영’을<br/>
                                LG의 행동방식인 ‘정도경영’으로 실천함으로써 LG의 비전인<br/>
                                ‘일등LG’를 달성하자는 것입니다.
                            </p>
                        </div>
                    </div>
                    <div class="button__wrap button__wrap--scroll-down">
                        <button type="button" class="">
                            <i class="ico icon-navigation-down-wh48"></i>
                            <span class="ir-text">다음 화면 보기</span>
                        </button>
                    </div>
                </div>

                <div class="bizinfo-LG-way__section full-sec bizinfo-LG-way__section--02">
                    <div class="inner-wrap">
                        <div class="bizinfo-LG-way__textarea">
                            <h2 class="font-head-lg font-bold">일등 LG</h2>
                            <p class="font-body-lg font-medium">
                                LG의 궁극적인 지향점으로<br/>
                                시장에서 인정받으며 시장을 리드하는<br/>
                                선도기업이 되는 것 입니다.
                            </p>
                            <div class="button__wrap">
                                <button type="button" class="popupBtn">
                                    <i class="ico icon-plus-wh24"></i>
                                    <span class="ir-text">LG 비전</span>
                                </button> <!-- 아이콘 등록 후 적용 필요 -->
                            </div>
                        </div>
                    </div>
                </div>

                <div class="bizinfo-LG-way__section full-sec bizinfo-LG-way__section--03">
                    <div class="inner-wrap">
                        <div class="bizinfo-LG-way__textarea">
                            <h2 class="font-head-lg font-bold">정도경영</h2>
                            <p class="font-body-lg font-medium">
                                윤리경영을 기반으로<br/>
                                꾸준히 실력을 배양해 정정당당하게<br/>
                                승부하는 LG만의 행동방식 입니다.
                            </p>
                            <div class="button__wrap">
                                <button type="button" class="popupBtn">
                                    <i class="ico icon-plus-wh24"></i>
                                    <span class="ir-text">정도경영</span>
                                </button><!-- 아이콘 등록 후 적용 필요 -->
                            </div>
                        </div>
                    </div>
                </div>

                <div class="bizinfo-LG-way__section full-sec bizinfo-LG-way__section--04">
                    <div class="inner-wrap">
                        <div class="bizinfo-LG-way__textarea">
                            <h2 class="font-head-lg font-bold">고객을 위한 가치창조,<br>인간존중의 경영</h2>
                            <p class="font-body-lg font-medium">
                                기업의 존립근거이자 회사운영의 원칙입니다.
                            </p>
                            <div class="button__wrap">
                                <button type="button" class="popupBtn">
                                    <i class="ico icon-plus-wh24"></i>
                                    <span class="ir-text">경영이념</span>
                                </button><!-- 아이콘 등록 후 적용 필요 -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="bizinfo-LG-way__section last-sec">
                <div class="inner-wrap">
                    <div class="bizinfo-LG-way__textarea">
                        <h2 class="font-head-sm font-bold">LG 임직원의 부당한 요구,</h2>
                        <p class="font-body-lg font-medium">
                            또는 불공정 업무처리로 불편함을 겪고있다면, 사이버 신문고를 두드려 보세요!<br>
                            고객님의 소중한 한마디가 새로운 기업문화의 밑거름이 됩니다.
                        </p>
                    </div>
                    <div class="button__wrap align-left">
                        <a href="#" class="btn btn-trans btn-small"> <!-- 버튼패딩 다름 -->
                            사이버 신문고 바로가기
                            <i class="ico icon-arrow-right-wt16"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <%- include('src/_inc/footer.html', Object.assign({}, locals, {
            type : 'transparent-color-wh',
        }))%>
    </div>
    <script>
        const container = document.querySelector('.bizinfo-LG-way__container');
        const sections = document.querySelectorAll('.bizinfo-LG-way__section.full-sec');
        const lastSection = document.querySelector('.bizinfo-LG-way__section.last-sec');
        const pagination = document.querySelector('.full-sec__pagination');
        const visualImgWrap = document.querySelector('.full-sec__img');
        const visualImgs = visualImgWrap.querySelectorAll('div');

        let currentIndex = 0;
        let isScrolling = false;
        let touchStartY = 0;

        // 섹션 이동 함수
        function moveToSection(index) {
            if (index < 0) return;

            isScrolling = true;
            currentIndex = index;

            const target = index >= sections.length ? lastSection : sections[index];
            const targetOffsetTop = target.offsetTop;

            window.scrollTo({
                top: targetOffsetTop,
                behavior: 'smooth'
            });

            setTimeout(() => {
                isScrolling = false;

                // 🔥 이 타이밍에 정확한 index 기반으로 처리
                updatePagination(currentIndex);
                updateImage(currentIndex);
            }, 800); // 스크롤 애니메이션 시간 고려
        }

        // 패럴렉스 이미지 이동 처리 (bottom 기준)
        function updateParallax() {
            const scrollY = window.scrollY;
            const sec02Top = sections[1].offsetTop;
            const sec04Top = sections[3].offsetTop;
            const lastTop = lastSection.offsetTop;

            if (scrollY >= sec02Top && scrollY < lastTop) {
                const moveRatio = (scrollY - sec02Top) / (sec04Top - sec02Top);
                const moveY = Math.max(0, 40 - moveRatio * 40); // 40% → 0%로 줄어듦
                visualImgWrap.style.bottom = `${moveY}%`;
                visualImgWrap.style.top = 'auto';
                visualImgWrap.classList.add('is-active');
                visualImgWrap.classList.remove('is-last');
            } else if (scrollY >= lastTop) {
                visualImgWrap.style.bottom = `0%`;
                visualImgWrap.style.top = 'auto';
                visualImgWrap.classList.add('is-last');
                visualImgWrap.classList.remove('is-active');
            } else {
                visualImgWrap.style.bottom = `40%`;
                visualImgWrap.style.top = 'auto';
                visualImgWrap.classList.remove('is-active');
                visualImgWrap.classList.remove('is-last');
            }
        }

        // 패럴렉스 이미지 교체
        function updateImage(index) {
            visualImgs.forEach((el, i) => {
                el.classList.toggle('is-active', i === index - 1);
            });
        }

        // 페이지네이션 active 처리
        function updatePagination(index) {
            const scrollY = window.scrollY;
            const windowH = window.innerHeight;
            const lastTop = lastSection.offsetTop;

            // pagination 영역 활성화 조건 (02~04에서만)
            pagination.classList.toggle('is-active', index >= 1 && index <= 3);

            // 마지막 섹션이 현재 화면에 걸쳐 있거나 완전히 도달했을 경우
            const isLastVisible = scrollY + windowH >= lastTop + 100; // 여유 margin 주는게 안정적

            // pagination.classList.toggle('is-last', isLastVisible);

            const items = pagination.querySelectorAll('.full-sec__pagination--item');
            items.forEach((el, i) => {
                el.classList.toggle('is-active', i === index - 1);
            });
        }

        // 휠 + 터치 이벤트 통합 처리
        function handleScroll(deltaY) {
            if (isScrolling) return;

            if (deltaY > 0) {
                if (currentIndex < sections.length) {
                moveToSection(currentIndex + 1);
                }
            } else if (deltaY < 0) {
                if (currentIndex > 0) {
                moveToSection(currentIndex - 1);
                }
            }
        }

        window.addEventListener('wheel', (e) => {
            if (window.scrollY >= lastSection.offsetTop && currentIndex >= sections.length) return;
            e.preventDefault();
            handleScroll(e.deltaY);
        }, { passive: false });

        window.addEventListener('touchstart', (e) => {
            touchStartY = e.touches[0].clientY;
        });

        window.addEventListener('touchmove', (e) => {
            if (window.scrollY >= lastSection.offsetTop && currentIndex >= sections.length) return;
            const deltaY = touchStartY - e.touches[0].clientY;
            handleScroll(deltaY);
        }, { passive: false });

        // 스크롤 시 패럴렉스 이미지 위치 갱신
        window.addEventListener('scroll', () => {
            updateParallax();
            updatePagination(currentIndex);
        });

        // 최초 상태 초기화
        window.addEventListener('DOMContentLoaded', () => {
            updateParallax();
            updatePagination(currentIndex);
            updateImage(currentIndex);
        });
    </script>
</body>
</html>